pipeline {
    agent any

    environment {
        REPO = "chakriamajalahub/e-commerce-web-site-frontend"
        TAG = "${env.BUILD_NUMBER}"
    }

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Build Docker Image') {
            steps {
                sh "docker build -t $REPO:$TAG ."
            }
        }

    stage('Run Container') {
    steps {
        echo "Stopping old container if exists..."
        sh "docker stop ecommerce || true"
        sh "docker rm ecommerce || true"

        echo "Running container..."
        sh "docker run -d --name ecommerce -p 8085:80 chakriamajalahub/e-commerce-web-site-frontend:${BUILD_NUMBER}"
    }
}

    }
}

